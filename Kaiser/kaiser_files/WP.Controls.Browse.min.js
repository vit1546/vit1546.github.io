/* Copyright Copyright 2014 Epic Systems Corporation. */

/*! Copyright (c) Epic Systems Corporation 2012 */
if(typeof WP==="undefined")WP={};if(typeof WP.Controls==="undefined")WP.Controls={};if(typeof WP.Controls.Browse==="undefined")WP.Controls.Browse={};WP.Controls.Browse.setupInner=function(a,d){var b="keydown",c=false;if(!a)return;if(typeof a==="string")a=parent.document.getElementById(a);a.browse=document.getElementById("upload");a.style.display="";a.timedOut=c;a.uploading=c;a.focusInner=function(){a.browse.focus()};a.setDisabledInner=function(b){a.browse.disabled=b;!b&&WP.Controls.Browse.fixButton(a)};a.timeOutChecks=a.timeOutChecks||0;a.writeError(d);WP.Events.addListener(a,"mouseover",function(){WP.Controls.Browse.fixButton(a)},true);WP.Events.addListener(a.browse,b,function(b){b=b||window.event;if((b.keyCode||b.which)===9){if(b.shiftKey===true)a.previousElement.focus();else a.nextElement.focus();WP.Events.cancelEvent(b);WP.Events.preventDefault(b);return c}});a.previousElement=WP.DOM.Search.getPreviousFocusable(a);a.nextElement=WP.DOM.Search.getNextFocusable(a);a.prevElemTab=function(b){return WP.Controls.Browse.iframeTab(a,b,c)};a.nextElemTab=function(b){return WP.Controls.Browse.iframeTab(a,b,true)};WP.Events.addListener(a.nextElement,b,a.nextElemTab);WP.Events.addListener(a.previousElement,b,a.prevElemTab);a.fixTabbing=function(a){var c,d;d=WP.DOM.Search.getPreviousFocusable(a);if(a.previousElement!==d){WP.Events.removeListener(a.previousElement,b,a.prevElemTab);a.previousElement=d;WP.Events.addListener(a.previousElement,b,a.prevElemTab)}c=WP.DOM.Search.getNextFocusable(a);if(a.nextElement!==c){WP.Events.removeListener(a.nextElement,b,a.prevElemTab);a.nextElement=c;WP.Events.addListener(a.nextElement,b,a.prevElemTab)}}};WP.Controls.Browse.getTimeOutFun=function(a,b){return function(){if(b!==a.timeOutChecks)return;if(a.uploading!==true)return;a.src=a.src;a.writeError("<span class=\"clearlabel\">Error: </span>The system timed out waiting for your attachment to upload.  Please try again.");a.timedOut=true;WP.Events.addListener(a.nextElement,"keydown",a.nextElemTab);WP.Events.addListener(a.previousElement,"keydown",a.prevElemTab)}};WP.Controls.Browse.afterBrowse=function(a){a.browse.blur();if(a.beforeupload()===false)return;a.uploading=true;window.setTimeout(WP.Controls.Browse.getTimeOutFun(a,++a.timeOutChecks),20*1e3);WP.Events.removeListener(a.nextElement,"keydown",a.nextElemTab);WP.Events.removeListener(a.previousElement,"keydown",a.prevElemTab);a.browse.form.submit()};WP.Controls.Browse.fixButton=function(a){var b=WP.DOM.Search.getFocused(a.browse,true);parent.WP.suppressErrors=true;a.browse.focus();window.setTimeout(function(){parent.WP.suppressErrors=false;if(a.keepFocus!==true){removeClassNames(a.button,"focus");b.focus()}a.keepFocus=false},1)};WP.Controls.Browse.iframeTab=function(e,c,d){var b,a;a=c||window.event;b=a.keyCode||a.which;if(b===9&&a.shiftKey===d){window.setTimeout(function(){e.focusInner()},1);return WP.Events.cancelEvent(c)}}