/* Copyright Copyright 2014 Epic Systems Corporation. */

$$WP.Utilities.declareComponent("Popups.TimeoutWarningPopup");$$WP.Popups.TimeoutWarningPopup.prototype={IsClosable:true,Class:"timeoutwarning",Content:{Text:""},SecondsLeft:60,_Init:function $$WP$Popups$TimeoutWarningPopup$_Init(b){var a=this,c=$$WP.Strings,e,d;c.setDefaultNamespace("Global.TimeOutPopup");e=$$WP.HyperspaceSession?"FromHyperspace":WP.Events.showBeforeUnloadMessage()?"WithChanges":"";a.Content=$$WP.Utilities.mergeObjects({Text:c.get(e+"Message")},a.Settings.Content,true,false);if($$WP.HyperspaceSession)d=[{Text:c.get("FromHyperspaceStayButtonText")}];else d=[{Text:c.get("StayButtonText")},{Class:"inlinedelete",Text:c.get("LogOutButtonText")}];a._clickContext=b._clickContext||a;a.Buttons=d;b.Title=b.Title||{};a.Title.Text=b.Title.Text||c.get(e+"Title");a.secondsAtStart=b.SecondsLeft||60;a.mnemonics.SecondsLeft=a.secondsAtStart;b.Class=b.Class||"";b.Class+=" timeoutwarning";a.Containers$Popup(b);c.clearDefaultNamespace();a.timer=$.proxy(a.timer,a);a.timerId=window.setTimeout(a.timer,1e3);a.d0=new Date;$$WP.Behaviors.EventHandlers.on("click",a);a.show()},secondsAtStart:60,d0:new Date,_click:function(b,a){a==="buttonbar1"&&$$WP.Popups.TimeoutWarningPopup.leaveClick();this.dispose()},timer:function $WP$Popups$TimeoutWarningPopup$timer(){var a=this,b=new Date;a.mnemonics.SecondsLeft=a.secondsAtStart-Math.round((b-a.d0)/1e3,0);if(a.mnemonics.SecondsLeft<0){$$WP.Popups.TimeoutWarningPopup.leaveClick();a.dispose()}else{a.timerId=window.setTimeout(a.timer,1e3);a.refresh()}},dispose:function $WP$Popups$TimeoutWarningPopup$dispose(){var a=this;window.clearTimeout(a.timerId);delete a.timerId;$$WP.Behaviors.EventHandlers.off("click",a);a.Containers$Popup$dispose();$$WP.Utilities.setActivity();checkActivity()}};$$WP.Popups.TimeoutWarningPopup.leaveClick=function $$WP$Controllers$TimeoutController$leaveClick(){WP.Events.cancelBeforeUnload();$$WP.Popups.TimeoutWarningPopup.LoggingOutPopup=new $$WP.Popups.LoggingOutPopup({PositioningFunction:$$WP.Containers.Positions.InsideCentered})};$$WP.Popups.TimeoutWarningPopup.extend("Containers.Popup")